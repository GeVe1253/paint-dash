<html lang="en"> 

<head> 

  <meta charset="UTF-8" /> 

  <title>CSV Fetch Example</title> 

  <!-- Load PapaParse from a CDN --> 

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script> 

 

  <script> 

    // Replace the link below with your published CSV link 

    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTHueh6aJe84zabgRcUtkC0TuHek2zba1Rj_1V7jWM4hp-iEZCl1ZFkNckcFONjIdi2hR4Ike2xXQTt/pub?output=csv"; 

 

    // Helper function to generate an HTML table from JSON data 

    function generateTable(data) { 

      if (data.length === 0) return "<p>No data found</p>"; 

 

      let table = `<table class="styled-table"> 

        <thead> 

          <tr>`; 

       

      Object.keys(data[0]).forEach(key => { 

        table += `<th>${key}</th>`; 

      }); 

 

      table += `</tr></thead><tbody>`; 

 

      data.forEach(row => { 

        table += `<tr>`; 

        Object.values(row).forEach(cell => { 

          table += `<td>${cell}</td>`; 

        }); 

        table += `</tr>`; 

      }); 

 

      table += `</tbody></table>`; 

      return table; 

    } 

 

    async function loadCsv() { 

      document.getElementById("csvTable").innerHTML = "<p>Loading...</p>"; 

 

      try { 

        const response = await fetch(csvUrl); 

        if (!response.ok) { 

          throw new Error("Network response was not ok: " + response.status); 

        } 

        const csvText = await response.text(); 

        const parsed = Papa.parse(csvText, { 

          header: true, 

          skipEmptyLines: true 

        }); 

 

        document.getElementById("csvTable").innerHTML = generateTable(parsed.data); 

 

      } catch (error) { 

        document.getElementById("csvTable").innerHTML = "<p>Error: " + error.message + "</p>"; 

        console.error(error); 

      } 

    } 

  </script> 

 

  <style> 

    body { 

      font-family: Arial, sans-serif; 

      text-align: center; 

      background-color: #f4f4f4; 

      margin: 0; 

      padding: 20px; 

    } 

 

    h1 { 

      color: #333; 

    } 

 

    button { 

      background-color: #4CAF50; 

      color: white; 

      padding: 10px 20px; 

      border: none; 

      cursor: pointer; 

      font-size: 16px; 

      border-radius: 5px; 

      transition: 0.3s; 

    } 

 

    button:hover { 

      background-color: #45a049; 

    } 

 

    .styled-table { 

      width: 80%; 

      margin: 20px auto; 

      border-collapse: collapse; 

      box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.2); 

      background-color: white; 

    } 

 

    .styled-table th, .styled-table td { 

      padding: 12px; 

      text-align: left; 

      border-bottom: 1px solid #ddd; 

    } 

 

    .styled-table thead { 

      background-color: #007BFF; 

      color: white; 

      text-transform: uppercase; 

    } 

 

    .styled-table tbody tr:nth-child(even) { 

      background-color: #f9f9f9; 

    } 

 

    .styled-table tbody tr:hover { 

      background-color: #f1f1f1; 

    } 

  </style> 

</head> 

<body> 

  <h1>Load CSV from Published Google Sheet</h1> 

  <button onclick="loadCsv()">Fetch Data</button> 

   

  <section id="csvTable"> 
    <p>Click "Fetch Data" to load CSV data into a neat table.</p> 
  </section> 

</body> 

</html> 
